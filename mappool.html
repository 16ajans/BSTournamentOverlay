<!DOCTYPE html>

<html>

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@700&family=Montserrat&family=Share+Tech&display=swap" rel="stylesheet">
</head>
<style>
    @font-face {
        font-family: 'Matamata';
        /*a name to be used later*/
        src: url('Matamata-Bold.otf');
        /*URL to font*/
        
    }

    .casterInfo {
        position: fixed;
        bottom: 10px;
        left: 10px;
        background-color: rgba(0, 0, 0, 0.0);
        text-align: center;
        font-family: 'Montserrat';
        font-weight: 600; 
        font-style: normal;
        overflow-wrap: break-word;
        overflow: hidden;
        color: rgb(255, 255, 255);
        width: 400px;
        height: 150px;
        line-height: 20px;
        text-shadow: 2px 2px #000000; 
        display:none;
    }

    .casterName {
        position: relative;
        text-align: center;
        top: 0;
        z-index: -1;
        font-size: 50px;
        line-height: 70px;
        width: 399.99px;
        display:none;
    }

    .mapPoolName {
        position: fixed;
        width: 600px;
        height: 80px;
        top: 190px;
        left: 660px;
        color: rgb(255, 255, 255);
        text-align: center;
        background-color: rgba(0, 0, 0, 0);
        border-radius: 25px;
        font-size: 60px;
        line-height: 70px;
        font-family: 'Montserrat';
        font-weight: 600; 
        font-style: normal;
        text-shadow: 0 0 3px #000000;
    }

    .SongArtist {
        position: absolute;
        text-align: center;
        top: 0.25em;
        width: 400px;
        z-index: 1;
        font-size: 25px;
    }

    .SongName {
        position: absolute;
        text-align: center;
        top: 1em;
        z-index: -1;
        font-size: 30px;
        line-height: 30px;
        width: 400px;
        overflow-wrap: normal;
    }

    .SongDiff {
        position: absolute;
        text-align: right;
        top: -15px;
        right: 15px;
        z-index: 2;
        font-size: 20px;


    }

    .SongKey {
        position: absolute;
        text-align: left;
        top: -15px;
        left: 15px;
        z-index: 2;
        font-size: 20px;


    }

    .SongMapper {
        position: absolute;
        text-align: center;
        bottom: 2px;
        z-index: 4;
        font-size: 20px;
        line-height: 0px;
        width: 400px;


    }

    html,body {
        height:100%; 
        overflow-y: hidden;
    }

    #sawGRID {
        margin-top: 320px;
        width: 100%;
        /* height: 100%; */
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-evenly;
        /* align-items: center;
        align-content: center; */
        gap: 1em;
    }

    .SongInfo {
        background-color: rgba(0, 0, 0, 0.0);
        text-align: center;
        font-family: 'Montserrat';
        font-weight: 600; 
        font-style: normal;
        overflow-wrap: break-word;
        overflow: hidden;
        color: rgb(255, 255, 255);
        width: 400px;
        height: 150px;
        line-height: 20px;
        text-shadow: 6px 6px 8px #000000;
        /* background-image: url('images/nosongcover.png'); */
        /* backdrop-filter: blur(8px) brightness(80%);
        background-position: center;
        background-size: cover; */
        position: relative;
    }

    .SongInfo::before {
        content: "";
        z-index: -4;

        display: block;
        background-image: url('images/nosongcover.png');
        background-size: cover;
        position: inherit;
        left: inherit;
        top: inherit;
        width: inherit;
        height: inherit;

        -webkit-filter: blur(8px) brightness(80%);
        -moz-filter: blur(8px) brightness(80%);
        -o-filter: blur(8px) brightness(80%);
        -ms-filter: blur(8px) brightness(80%);
        filter: blur(8px) brightness(80%);
}

    .PickOrBan {
        animation: fadeIn;
        animation-duration: 2s;
        position: absolute;
        bottom: -100px;
        right: 0px;
        width: 400px;
        height: 400px;
        z-index: -3;

    }
</style>

<body>
    <div class=casterInfo>
        <span id="caster1Name" class="casterName">Caster 1</span><br>
        <span id="caster2Name" class="casterName">Caster 2</span>
    </div>

    <div class="mapPoolName">
        <span id="mapPoolName">???????</span>

    </div>

    <div id="sawGRID">

    <div class="SongInfo s0" id="song0" style="border-radius:25px;">
        <p id="SongArtist0" class="SongArtist">Artist</p>
        <p id="SongName0" class="SongName">Song Name</p>
        <p id="SongMapper0" class="SongMapper">Mapper</p>
        <p id="SongDiff0" class="SongDiff">Diff</p>
        <p id="SongKey0" class="SongKey">Key</p>
        <img id="pickBan0" src="" class="none">
        <!-- <img id="songCover0" src="images/nosongcover.png" class="SongCover"> -->
    </div>


    <div class="SongInfo s1" id="song1" style="border-radius:25px;">
        <p id="SongArtist1" class="SongArtist">Artist</p>
        <p id="SongName1" class="SongName">Song Name</p>
        <p id="SongMapper1" class="SongMapper">Mapper</p>
        <p id="SongDiff1" class="SongDiff">Diff</p>
        <p id="SongKey1" class="SongKey">Key</p>
        <img id="pickBan1" src="" class="none">
        <!-- <img id="songCover1" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s2" id="song2" style="border-radius:25px;">
        <p id="SongArtist2" class="SongArtist">Artist</p>
        <p id="SongName2" class="SongName">Song Name</p>
        <p id="SongMapper2" class="SongMapper">Mapper</p>
        <p id="SongDiff2" class="SongDiff">Diff</p>
        <p id="SongKey2" class="SongKey">Key</p>
        <img id="pickBan2" src="" class="none">
        <!-- <img id="songCover2" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s3" id="song3" style="border-radius:25px;">
        <p id="SongArtist3" class="SongArtist">Artist</p>
        <p id="SongName3" class="SongName">Song Name</p>
        <p id="SongMapper3" class="SongMapper">Mapper</p>
        <p id="SongDiff3" class="SongDiff">Diff</p>
        <p id="SongKey3" class="SongKey">Key</p>
        <img id="pickBan3" src="" class="none">
        <!-- <img id="songCover3" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s4" id="song4" style="border-radius:25px;">
        <p id="SongArtist4" class="SongArtist">Artist</p>
        <p id="SongName4" class="SongName">Song Name</p>
        <p id="SongMapper4" class="SongMapper">Mapper</p>
        <p id="SongDiff4" class="SongDiff">Diff</p>
        <p id="SongKey4" class="SongKey">Key</p>
        <img id="pickBan4" src="" class="none">
        <!-- <img id="songCover4" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s5" id="song5" style="border-radius:25px;">
        <p id="SongArtist5" class="SongArtist">Artist</p>
        <p id="SongName5" class="SongName">Song Name</p>
        <p id="SongMapper5" class="SongMapper">Mapper</p>
        <p id="SongDiff5" class="SongDiff">Diff</p>
        <p id="SongKey5" class="SongKey">Key</p>
        <img id="pickBan5" src="" class="none">
        <!-- <img id="songCover5" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s6" id="song6" style="border-radius:25px;">
        <p id="SongArtist6" class="SongArtist">Artist</p>
        <p id="SongName6" class="SongName">Song Name</p>
        <p id="SongMapper6" class="SongMapper">Mapper</p>
        <p id="SongDiff6" class="SongDiff">Diff</p>
        <p id="SongKey6" class="SongKey">Key</p>
        <img id="pickBan6" src="" class="none">
        <!-- <img id="songCover6" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s7" id="song7" style="border-radius:25px;">
        <p id="SongArtist7" class="SongArtist">Artist</p>
        <p id="SongName7" class="SongName">Song Name</p>
        <p id="SongMapper7" class="SongMapper">Mapper</p>
        <p id="SongDiff7" class="SongDiff">Diff</p>
        <p id="SongKey7" class="SongKey">Key</p>
        <img id="pickBan7" src="" class="none">
        <!-- <img id="songCover7" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s8" id="song8" style="border-radius:25px;">
        <p id="SongArtist8" class="SongArtist">Artist</p>
        <p id="SongName8" class="SongName">Song Name</p>
        <p id="SongMapper8" class="SongMapper">Mapper</p>
        <p id="SongDiff8" class="SongDiff">Diff</p>
        <p id="SongKey8" class="SongKey">Key</p>
        <img id="pickBan8" src="" class="none">
        <!-- <img id="songCover8" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s9" id="song9" style="border-radius:25px;">
        <p id="SongArtist9" class="SongArtist">Artist</p>
        <p id="SongName9" class="SongName">Song Name</p>
        <p id="SongMapper9" class="SongMapper">Mapper</p>
        <p id="SongDiff9" class="SongDiff">Diff</p>
        <p id="SongKey9" class="SongKey">Key</p>
        <img id="pickBan9" src="" class="none">
        <!-- <img id="songCover9" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s10" id="song10" style="border-radius:25px;">
        <p id="SongArtist10" class="SongArtist">Artist</p>
        <p id="SongName10" class="SongName">Song Name</p>
        <p id="SongMapper10" class="SongMapper">Mapper</p>
        <p id="SongDiff10" class="SongDiff">Diff</p>
        <p id="SongKey10" class="SongKey">Key</p>
        <img id="pickBan10" src="" class="none">
        <!-- <img id="songCover10" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <div class="SongInfo s11" id="song11" style="border-radius:25px;">
        <p id="SongArtist11" class="SongArtist">Artist</p>
        <p id="SongName11" class="SongName">Song Name</p>
        <p id="SongMapper11" class="SongMapper">Mapper</p>
        <p id="SongDiff11" class="SongDiff">Diff</p>
        <p id="SongKey11" class="SongKey">Key</p>
        <img id="pickBan11" src="" class="none">
        <!-- <img id="songCover11" src="images/nosongcover.png" class="SongCover"> -->
    </div>

    <style id="styleOverwrite">

    </style>

</div>

</body>

<script>
    function connect() {

        sock = new WebSocket("ws://localhost:1337");
        sock.onopen = function () {
            console.log("Connected to BSTournamentHelper");
        };

        sock.onclose = function (e) {
            console.log("Socket is closed. Reconnect attempt in 1 second");
            setTimeout(function () {
                connect();
            }, 1000);
        }

        sock.onerror = function (err) {
            console.log(err);
            sock.close();
        }
        sock.onmessage = function (msg) {
            let data = JSON.parse(msg.data);
            console.log(data);

            if (data.Event == "MatchData") {
                MapPool = data.Data.MapPool + '';
                Map0 = data.Data.Map0;
                Map1 = data.Data.Map1;
                Map2 = data.Data.Map2;
                Map3 = data.Data.Map3;
                Map4 = data.Data.Map4;
                Map5 = data.Data.Map5;
                Map6 = data.Data.Map6;
                Map7 = data.Data.Map7;
                Map8 = data.Data.Map8;
                Map9 = data.Data.Map9;
                Map10 = data.Data.Map10;
                Map11 = data.Data.Map11;
                Map12 = data.Data.Map12;
                mapPoolUpdate();


                caster1 = data.Data.Caster1;
                caster2 = data.Data.Caster2;
                caster1Name.innerText = caster1;
                caster2Name.innerText = caster2;
            }

        }
    }

    function mapPoolUpdate() {
        let data = {
        "1": {
            "poolName": "Div. 1",
            "songs": [
	{ songAuthor: 'Gourmet Race', name: '(Qumu Remix)', levelAuthor: 'Rashed', diff: 'Hard', key: '2680c', hash: '075a3c6598289bd485bb0319718031f5528e5ca2'},
    { songAuthor: 'Gold', name: 'Echos', levelAuthor: 'Olaf', diff: 'Expert+', key: '36cab', hash: '50bce3ee46cdc11557e5969247689c06aa55b6b1'},
    { songAuthor: 'Rec Hall', name: 'She Doesn’t Get It', levelAuthor: 'Chromia', diff: 'Expert+', key: '360ed', hash: '91febe27ee06b27de9ec2b6c4c5d26079136f00e'},
    { songAuthor: 'Five Finger Deathpunch', name: 'Lift Me Up', levelAuthor: 'Olaf', diff: 'Expert+', key: '33c67', hash: '1939dd6d7131de4397231a6ff99a5a146f789dcf'},
    { songAuthor: 'USAO & Kobaryo', name: 'WACCA ULTRA DREAM MEGAMIX', levelAuthor: 'Nolanimations', diff: 'Tanoc+', key: '36cb1', hash: '825ecc693778e112609168ede82642076c585a9b'},
    { songAuthor: 'Curbi ft. Jess Ball', name: 'Lied To', levelAuthor: 'oegoe', diff: 'Lied To (Tech)', key: '34c35', hash: '64606ce394718815deecd696737ea1aee40e8cf4'},
	{ songAuthor: 'Giga & TeddyLoid', name: 'Kitsuneno Mado (Queen Fox) (covered by KOKO)', levelAuthor: 'Gabriel', diff: 'Expert+', key: '34873', hash: '409db485951246edffad7667e950c50ee938fb6a'},
    { songAuthor: 't+pazolite', name: 'Hoshikuzu Struck', levelAuthor: 'Joshabi', diff: 'Expert+', key: '355d8', hash: '1d47953a0492547c6e04aabe6fb2ea78c5a6f87c'},
    { songAuthor: 'The Hero !!!', name: 'cover by Jonathan Young', levelAuthor: 'Emir', diff: 'Expert+', key: '31b86', hash: '9bc732ce7d9003948df7a46d2aba593565c789d0'},
    { songAuthor: 'Ashrount', name: 'AureoLe ~for Triumph~', levelAuthor: 'Cobayo & Nolanimations', diff: 'Expert', key: '254fc', hash: '44cf3b0235470221fcd1e0ce5a8bc9fe87a041fe'},
    { songAuthor: 'Camellia', name: 'Exit This Earth’s Atomosphere', levelAuthor: 'Aquaflee', diff: 'Hypersonic', key: '33317', hash: '74a2ac567499e7a170f385c0ab5b7cd3ee93a73b'}]},
        "2": {
            "poolName": "Div. 2",
            "songs": [
	{ songAuthor: 'Stellar', name: 'El Dorado', levelAuthor: 'Melon', diff: 'Easy', key: '35333', hash: 'dc44b1632e211749dbfd777b70c4196d55d24fa1'},
    { songAuthor: 'Gold', name: 'Echos', levelAuthor: 'Olaf', diff: 'Expert+', key: '36cab', hash: '50bce3ee46cdc11557e5969247689c06aa55b6b1'},
    { songAuthor: 'Dance Gavin Dance', name: 'Back On Deck', levelAuthor: 'Melon', diff: 'Expert+', key: '328b4', hash: '9fdb0db57c754b58369046cc803c60c8d95beb77'},
    { songAuthor: 'Mine', name: 'POWFU', levelAuthor: 'Olaf', diff: 'ExpertPlus', key: '2fad1', hash: '5fbde9a39457b63f272b6dc632361029584b3de3'},
    { songAuthor: 'Origami Angel', name: 'The Title Track', levelAuthor: 'Harbgy', diff: 'A', key: '27142', hash: 'b90d1ffd137c8f2db90d95780fd7a8de3d35e3eb'},
    { songAuthor: 'Sakuzyo', name: 'Synthesized Angel', levelAuthor: 'Slayx', diff: 'Expert+', key: '358e9', hash: '14de09851cecc21f9e0a6aa80164995ce7a47d51'},
	{ songAuthor: 'Kanaria (ft. Seisei)', name: 'Requiem', levelAuthor: 'EOP Glacier', diff: 'Expert+', key: '31da8', hash: '56c281c3a43c4ee198d2d3351da7ae6932fb5bd0'},
    { songAuthor: 'Sana', name: 'Packet Hero', levelAuthor: 'Joshabi', diff: 'Expert+', key: '3357c', hash: 'db9588466cd0d60bb461e8e4b7e5badc3f6b6c73'},
    { songAuthor: 'CS4W', name: 'EX-ris', levelAuthor: 'ilvory', diff: 'Expert+', key: '3554e', hash: '32c9a4bf8c05028cbcef32030c69949ac5fb18fd'},
    { songAuthor: 'Ludicin', name: 'Onus Rēgulus', levelAuthor: 'Slayx', diff: 'Hard', key: '35f5b', hash: 'f9b192855f44ec3e0047895935dd1f8b86aec75e'},
    { songAuthor: 'Camellia', name: 'Machinegun', levelAuthor: 'Cerret', diff: 'Machine', key: '34e06', hash: '26b5524ef7f156d35a9710c37e472e301e14bff3'}]}
    }
                console.log(data);
                // Do stuff here
                levelIDs = [];
                levelNames = [];
                levelArtists = [];
                levelMappers = [];
                levelDiffs = [];
                levelHashes = [];
                levelHashesLower = [];

                console.log(MapPool);
                var mapCount = 0;
                mapPoolName.innerHTML = data[MapPool].poolName;



                console.log(MapPool);
                for (var i = 0; i < data[MapPool].songs.length; i++) {

                    levelIDs.push(data[MapPool].songs[i].key);
                    levelNames.push(data[MapPool].songs[i].name);
                    levelArtists.push(data[MapPool].songs[i].songAuthor);
                    levelMappers.push(data[MapPool].songs[i].levelAuthor);
                    levelDiffs.push(data[MapPool].songs[i].diff);
                    levelHashes.push(data[MapPool].songs[i].hash);

                    levelHashesLower[i] = levelHashes[i].toLowerCase();

                    mapCount = data[MapPool].songs.length;
                    console.log(mapCount);

                    SongName = [];
                    SongArtist = [];
                    SongKey = [];
                    SongMapper = [];
                    SongDiff = [];
                    SongHash = [];

                    for (let i = 0; i < 12; i++) {
                        if (i < mapCount) {
                            document.getElementById("song" + i).style.display = "block";
                        } else {
                            document.getElementById("song" + i).style.display = "none";
                        }
                    }

                    namePush();
                    artistPush();
                    keyPush();
                    mapperPush();
                    diffPush();
                    coverPush();
                    pickOrBan();

                    function namePush() {
                        for (let i = 0; i < mapCount; i++) {
                            SongName.push(levelNames[i]);
                            eval('SongName' + i + " = '" + SongName.at(i) + "'") 
                            document.getElementById('SongName' + i).innerHTML = eval('SongName' + i);
                        }
                    }

                    function artistPush() {

                        for (let i = 0; i < mapCount; i++) {
                            SongArtist.push(levelArtists[i]);
                            eval('SongArtist' + i + " = '" + SongArtist.at(i) + "'") 
                            document.getElementById('SongArtist' + i).innerHTML = eval('SongArtist' + i);
                        }
                    }

                    //Song Key
                    function keyPush() {
                        for (let i = 0; i < mapCount; i++) {
                            SongKey.push(levelIDs[i]);
                            eval('SongKey' + i + " = '" + SongKey.at(i) + "'") 
                            document.getElementById('SongKey' + i).innerHTML = eval('SongKey' + i);
                        }
                    }

                    // Song Mapper 
                    function mapperPush() {
                        for (let i = 0; i < mapCount; i++) {
                            SongMapper.push(levelMappers[i]);
                            eval('SongMapper' + i + " = '" + SongMapper.at(i) + "'") 
                            document.getElementById('SongMapper' + i).innerHTML = eval('SongMapper' + i);
                        }
                    }

                    // Song Diff
                    function diffPush() {
                        for (let i = 0; i < mapCount; i++) {
                            SongDiff.push(levelDiffs[i]);
                            eval('SongDiff' + i + " = '" + SongDiff.at(i) + "'") 
                            document.getElementById('SongDiff' + i).innerHTML = eval('SongDiff' + i);
                        }

                    }
                    // Song Cover
                    function coverPush() {
                        let styleOverwrite = document.getElementById("styleOverwrite")

                        let styles = "";

                        for (let i = 0; i < mapCount; i++) {
                            styles += ".SongInfo.s" + i + "::before {background-image: url('" + "https://na.cdn.beatsaver.com/" + levelHashesLower.at(i) + ".jpg" + "');} "
                        }

                        styleOverwrite.innerHTML = styles
                    }


                }



    }

    function pickOrBan() {

        for (let i = 0; i < 11; i++) {
        if (eval('Map' + i) != "default") {
            document.getElementById('pickBan' + i).src = "images/" + eval('Map' + i) + ".png";
            document.getElementById("pickBan" + i).className = "PickOrBan";
        } else {
            document.getElementById('pickBan' + i).src = "";
            document.getElementById("pickBan" + i).className = "none";
        }
        }
    }

    function returnLast(arr) {
        return arr.at(-1);
    }
    connect();
</script>





</html>